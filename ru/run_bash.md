---
lang: ru
layout: home
lang-ref: run_bash
---

## Запуск оболочки (Bash)

В "режиме" взаимодействия с пользователем оболочка запускается в случаях:

* когда у оболочки нет "аргументов", либо когда её "аргументы" являются
  "опциями", кроме `-c`:

```bash
bash
bash -v
bash --verbose
...
```

* в случае `-s` у оболочки могут быть "аргументы" не являющиеся её "опциями":

```bash
bash -s привет
```

* либо когда явно указан такой "режим" запуска с помощью `-i`.

```bash
bash -i
```

В "режиме" входа оболочка запускается когда мы, собственно, входим в оболочку
(в данном случае значение $0 будет начинаться со знака "-"), либо при явном
указании ключа `-l`.

##### Включение/выключение "библиотеки" readline

В "режиме" взаимодействия используется GNU "библиотека" readline, которую можно
отключить с помощью `--noediting`. Без неё тебе будут недоступны такие
возможности как возврат к предыдущей выполненной "команде" с помощью нажима на
стрелку вверх или, например, дополнение "команды" при её наборе посредством
нажима Tab. В общем, не советую усложнять себе жизнь.

#### Запуск "команд" из строки

```bash
bash -c 'echo "Выполняем действие из строки"'
bash -c 'echo "Выполняем действие из строки \
и меняем значение \$0 на $0"' новый_ноль
bash -c 'echo "Выполняем действие из строки \
с изменением \$0 и \$1 и т.д"' новый_ноль новый_один
```

Остальные "аргументы", идущие после строки с "командой" задают порядковые
переменные $0, $1, $2 ..., причём, следует иметь в виду, что:

$0 -- содержит имя оболочки, которое используется в предупреждающих сообщениях и
ошибках.

#### Запуск из "стандартного" ввода

```bash
echo "ls" | bash -s
```

#### Задаём порядковые переменные при запуске

Первый способ посредством передачи их после строки при использовании `-c`, как
было показано выше.

Второй способ с помощью `-s`:

```bash
bash -s привет
echo $1
привет
```

Причём, как можно заметить, первый "аргумент" задаёт значение для $1, а не для
$0, как в случае с `-c`.

#### Запускаем оболочку с выводом исполняемых "команд"

```bash
bash -v
bash --verbose
```

Теперь каждая выполняемая "команда" будет выводиться на "экран", прежде чем
будет исполнена. Бывает полезно для отладки испольняемого "скрипта".

#### Узнать сведения о текущей оболочке

```bash
bash --version
```

#### Получить краткую справку по оболочке

```bash
bash --help
```

### "Файлы" которые исполняются при запуске оболочки

В "режиме" взаимодействия, либо в "режиме" невзаимодействия при заданном ключе
`-l`:

* читает "команды" из /etc/profile, если он доступен;
* затем ищет "файлы" в следующем порядке:  ~/.bash_profile, ~/.bash_login, ~/.profile.
  Затем выполняет "команды" из первого найденного среди этих трёх. Запретить
  выполнение "команд" из вышеперечисленных файлов можно с помощью ключа `--noprofile`.

Взаимодействующая оболочка, которая не является входной, при запуске выполняет
указания из /etc/bash.bashrc и ~/.bashrc. Это поведение может быть отключено
посредством ключа `--norc`. При запуске оболочки как `sh` этот ключ установлен
по умолчанию. С помощью ключа `--rcfile` можно явно задать "файл" из которого
будут считываться указания вместо двух вышеупомянутых.

При запуске невзаимодействующей оболочки, считывается значение BASH_ENV, которое
используется в качестве "подгружаемого" "файла" перед непосредственным выполнением
указаний из выполняемого "скрипта".

m.sh:

```bash
#!/bin/bash

echo $ASDF
```

запуск m.sh с подгружаемым "файлом":

```bash
echo "ASDF=1234" > asdf.conf
BASH_ENV=asdf.conf bash ./m.sh
1234
```
Взаимодействующая оболочка с ключом `--posix` работает по правилам POSIX, в
части выполнения загрузочных "файлов", которые в данном случае она берёт из
переменной ENV. Другие загрузочные "файлы" в данном случае не выполняются.

В случае удалённого запуска оболочки выполняются указания из "файла" ~/.bashrc.

При запуске оболочки в случае, когда действующий EUID отличается от
действительного RUID, тогда загрузочные "файлы" не исполняются, как и "функции"
оболочки, также не устанавливаются значения для SHELLOPTS, BASHOPTS,
CDPATH, GLOBIGNORE. Когда не задан ключ `-p` EUID сбрасывается до значения RUID.

#### Особенности при запуске оболочки как sh

При запуске взаимодействующей оболочки или невзаимодействующей с `-l` читает и
выполняет указания из `/etc/profile` и `~/.profile` (запретить можно с помощью
`--noprofile`.

Вместо BASH_ENV используется значение из ENV.

Никакие rc-"файлы" не выполняются, `--norc` по умолчанию.

Невзаимодействующая оболочка, при запуске, другие "загрузочные" "файлы" не читает.

### "Файлы" которые исполняются при выходе из оболочки

При выходе из взаимодействующей оболочки, либо при выходе из невзаимодействующей
оболочки входа при выполнении "команды" `exit` выполняются "команды" из файла:
~/.bash_logout
